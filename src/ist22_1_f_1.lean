import Mathlib.Data.Real.Basic
import Mathlib.Tactic

theorem ist22_1_f_1 (x₁ x₂ : ℝ)
                    (h₁ : f₁ = (x₁-1.2)*(5-x₁))
                    (h₂ : f₂ = (x₂-2.2)*(5-x₂))
                    (h₃ : I =  (17*x₁)/2 - (151*x₂)/10 - (407*x₁^2*x₂^2)/10 - (13*x₁*x₂)/5
                    - (35*x₁*x₂^2)/2 + (123*x₁^2*x₂)/5 + (149*x₁*x₂^3)/5 + (103*x₁^3*x₂)/5
                    - (19*x₁^2)/5 - (131*x₁^3)/10 + (174*x₂^2)/5 - (9*x₁^4)/10 - (109*x₂^3)/5 - x₂^4 - 39/10) :
                    0 ≤ f₁ → 0 ≤ f₂ → 0 < I := by
  let p₀ : ℝ := (1223*x₁*x₂)/25 - (27587*x₂)/100 - (231*x₁)/5 - (84*x₁^2)/5 + (753*x₂^2)/20 + 3712999/10000
  let p₁ : ℝ := (10279979533*x₂)/185649950 - (23821070017*x₁)/371299900 - (1350270619*x₁*x₂)/185649950
                  + (7287823789*x₁^2)/371299900 - (189857534*x₂^2)/18564995
  let p₂ : ℝ := (64146047963737*x₁)/2055995906600 - (3785561560966*x₁*x₂)/256999488325
                  - (327427959759*x₁^2)/2055995906600 + (55097377119*x₂^2)/102799795330
  let p₃ : ℝ := (489138583089283*x₁^2)/1282920959274740 - (481568569121447*x₁*x₂)/641460479637370 + (18239229660781*x₂^2)/64146047963737
  let p₄ : ℝ := (41068082618995*x₁*x₂)/72956918643124 - (2651831812338563*x₁^2)/3647845932156200
  let p₅ : ℝ := (3240241791736219*x₁^2)/102670206547487500

  let p₆ : ℝ := (341*x₁)/20 - (683*x₂)/20 + 42
  let p₇ : ℝ := (44231*x₂)/16800 - (48497*x₁)/16800
  let p₈ : ℝ := (2956*x₁)/221155

  let p₉ : ℝ := 56/5 - (21*x₂)/10 - (41*x₁)/20
  let q₀ : ℝ := (1057*x₂)/160 - (639*x₁)/64
  let q₁ : ℝ := (38789*x₁)/21140

  let σ₀ : ℝ := 10000/3712999*p₀^2 + 185649950/10279979533*p₁^2 + 2055995906600/64146047963737*p₂^2
                + 64146047963737/18239229660781*p₃^2 + 72956918643124/41068082618995*p₄^2 + 102670206547487500/3240241791736219*p₅^2
  let σ₁ : ℝ := 1/42*p₆^2 + 16800/44231*p₇^2 + 221155/2956*p₈^2
  let σ₂ : ℝ := 5/56*p₉^2 + 160/1057*q₀^2 + 21140/38789*q₁^2
  let ε : ℝ := 1/10000
  have I₁ : I = σ₀ + σ₁*f₁ + σ₂*f₂ + ε := by
    simp [h₁, h₂, h₃]
    linear_combination
  intro f1 f2
  rw [I₁]
  have h1 : 0 ≤ σ₀ := by
    have : 0 ≤ (1223 * x₁ * x₂ / 25 - 27587 * x₂ / 100
          - 231 * x₁ / 5 - 84 * x₁ ^ 2 / 5 + 753 * x₂ ^ 2 / 20 + 3712999 / 10000) ^ 2 := by apply pow_two_nonneg
    have : 0 ≤ (10279979533 * x₂ / 185649950 - 23821070017 * x₁ / 371299900 - 1350270619 * x₁ * x₂ / 185649950 +
                    7287823789 * x₁ ^ 2 / 371299900 - 189857534 * x₂ ^ 2 / 18564995) ^ 2 := by apply pow_two_nonneg
    have : 0 ≤ (64146047963737 * x₁ / 2055995906600 - 3785561560966 * x₁ * x₂ / 256999488325 -
                  327427959759 * x₁ ^ 2 / 2055995906600 + 55097377119 * x₂ ^ 2 / 102799795330) ^ 2 := by apply pow_two_nonneg
    have : 0 ≤ (489138583089283 * x₁ ^ 2 / 1282920959274740 - 481568569121447 * x₁ * x₂ / 641460479637370
                  + 18239229660781 * x₂ ^ 2 / 64146047963737) ^ 2 := by apply pow_two_nonneg
    have : 0 ≤ (41068082618995 * x₁ * x₂ / 72956918643124 - 2651831812338563 * x₁ ^ 2 / 3647845932156200) ^ 2 := by apply pow_two_nonneg
    have : 0 ≤ 102670206547487500 / 3240241791736219 * ((3240241791736219 * x₁ ^ 2) ^ 2 / 102670206547487500 ^ 2):= by
      rw [←div_pow]
      have : 0 ≤ (3240241791736219 * x₁ ^ 2 / 102670206547487500) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have h2 : 0 ≤ σ₁*f₁ := by
    have : 0 ≤ σ₁ := by
      have : 0 ≤ (341 * x₁ / 20 - 683 * x₂ / 20 + 42) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ (44231 * x₂ / 16800 - 48497 * x₁ / 16800) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ 221155 / 2956 * ((2956 * x₁) ^ 2 / 221155 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ (2956 * x₁ / 221155) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this f1
  have h3 : 0 ≤ σ₂*f₂ := by
    have : 0 ≤ σ₂ := by
      have : 0 ≤ (56 / 5 - 21 * x₂ / 10 - 41 * x₁ / 20) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ (1057 * x₂ / 160 - 639 * x₁ / 64) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ 21140 / 38789 * ((38789 * x₁) ^ 2 / 21140 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ (38789 * x₁ / 21140) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this f2
  have : 0 < ε := by norm_num
  linarith
