import Mathlib.Tactic  ---在数学库（Mathlib）中用于处理自动证明的策略（tactic）的文件
import Mathlib.Order.Basic   --关于基本的排序理论的文件

theorem exp1 (x₁ x₂ y: ℝ)
             (h₁ : f₁=-3 *x₁^2 - x₂^2 + 1)
             (h₂ : f₂ = -1 *y^2  + x₂)
             (h₃: I = 107/50*x₂ - 2881/1000*x₁ - 2479/1000*x₁*x₂ - 327/500*x₁^2 - 147/125*x₂^2 + 581/200):
              0 ≤ f₁ ∧  0 ≤ f₂
                →  I > 0 := by
  let p₀: ℝ := (381*x₂)/1000 - (2871*x₁)/2000 - (537*x₁*x₂)/800 - (731*x₁^2)/1500 - (369*x₂^2)/500 - (323*y^2)/750 + 463/250
  let p₁: ℝ := (35780621*x₁)/22224000 - (910939*x₂)/3704000 - (1645187*x₁*x₂)/14816000- (727347*x₁^2)/1852000 - (281559*x₂^2)/1852000 - (93353*y^2)/926000
  let p₂: ℝ := (747861443*x₂)/894515525- (76962704289*x₁*x₂)/286244968000 - (28694063011*x₁^2)/143122484000 - (1130660241*x₂^2)/8945155250- (8222434883*y^2)/35780621000
  let p₃: ℝ := (8571789992422891*x₁^2)/4307681911680000 -(5071022337719*x₁*x₂)/23347869440000 + (12570716568667*x₂^2)/89743373160000 + (148589533955243*y^2)/1076920477920000
  let p₄: ℝ := (5396711918315107757*x₂^2)/8571789992422891000 - (377595226097715311*x₁*x₂)/1318736921911214000- (1657661435566708657*y^2)/12857684988634336500
  let p₅: ℝ := (8154076148600657476273*y^2)/9714081452967193962600 -(6412026553257505137151*x₁*x₂)/32380271509890646542000
  let p₆: ℝ := (1131919696787266928609295991*x₁*x₂)/489244568916039448576380000
  let p₇: ℝ := (877*y)/750 - (277*x₁*y)/1000 - (503*x₂*y)/1000
  let p₈: ℝ := (12316199*x₂*y)/10524000 - (830183*x₁*y)/3508000
  let p₉: ℝ := (25833556029*x₁*y)/12316199000
  let p₀': ℝ := (9*x₂)/50 - x₁/200 + 263/250
  let p₁': ℝ := (793183*x₁)/1052000 + (587*x₂)/32875
  let p₂': ℝ := (742243733*x₂)/793183000
  let p₃': ℝ := (71*y)/100
  let p0: ℝ := 509/500 - (567*x₂)/2000 - (11*x₁)/250
  let p1: ℝ := (377219*x₁)/509000 - (6013*x₂)/127250
  let p2: ℝ := (2378096993*x₂)/3017752000
  let p3: ℝ := (209*y)/200
  let ε: ℝ :=  1/1000
  let σ₀: ℝ := 250/463*(p₀^2) + 22224000/35780621*(p₁^2) + 894515525/747861443*(p₂^2)+4307681911680000/8571789992422891*(p₃^2)+
          8571789992422891000/5396711918315107757*(p₄^2)+ 9714081452967193962600/8154076148600657476273*(p₅^2)+ 489244568916039448576380000/1131919696787266928609295991*(p₆)^2 +
          750/877*(p₇^2)+ 10524000/12316199*(p₈^2)+ 12316199000/25833556029*(p₉^2)
  let σ₁: ℝ :=250/263*(p₀'^2) + 1052000/793183*(p₁'^2) + 793183000/742243733*(p₂'^2) + 100/71*(p₃'^2)
  let σ₂: ℝ := 500/509*(p0^2) + 509000/377219*(p1^2) + 3017752000/2378096993*(p2^2) +200/209*(p3^2)
  have h1 :250/463*(p₀^2) + 22224000/35780621*(p₁^2) + 894515525/747861443*(p₂^2)+4307681911680000/8571789992422891*(p₃^2)+
          8571789992422891000/5396711918315107757*(p₄^2)+ 9714081452967193962600/8154076148600657476273*(p₅^2)+ 489244568916039448576380000/1131919696787266928609295991*(p₆)^2 +
          750/877*(p₇^2)+ 10524000/12316199*(p₈^2)+ 12316199000/25833556029*(p₉^2)= σ₀ := by exact rfl
  have h2 : 250/263*(p₀'^2) + 1052000/793183*(p₁'^2) + 793183000/742243733*(p₂'^2) + 100/71*(p₃'^2) = σ₁ := by exact rfl
  have h3 : 500/509*(p0^2) + 509000/377219*(p1^2) + 3017752000/2378096993*(p2^2) +200/209*(p3^2) = σ₂ := by exact rfl
  have D₁: I = σ₀ + σ₁*f₁ + σ₂*f₂ + ε := by
    linear_combination -(967/1000*x₂^2 + 17/500*x₁*x₂ + 9/25*x₂ + 377/500*x₁^2 - 1/100*x₁ + 263/250 + 71/100*y^2)* h₁ -
     (509/500 - 567/1000*x₂ - 11/125*x₁ + 87/100*x₂^2 - 7/100*x₁*x₂ + 743/1000*x₁^2 + 209/200*y^2) * h₂ + h₃ - h1 - f₁ * h2 - f₂ * h3 - 1/1000
  have l₀: σ₀ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by --开始证明每一个平方和项大于等于0
          exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁
    have : p₂ ^ 2 ≥ 0 := by
          exact sq_nonneg p₂
    have : p₃ ^ 2 ≥ 0 := by
          exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
          exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
          exact sq_nonneg p₅
    have : p₆ ^ 2 ≥ 0 := by
          exact sq_nonneg p₆
    have : p₇ ^ 2 ≥ 0 := by
          exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
          exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
          exact sq_nonneg p₉
    linarith
  have l₁: σ₁ ≥ 0 := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by  --开始证明每一个平方和项大于等于0
      exact sq_nonneg p₀' --应用策略sq_nonneg（x^ 2 ≥ 0)
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    linarith
  have l₂: σ₂ ≥ 0 := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by --开始证明每一个平方和项大于等于0
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    linarith
  rw [D₁]
  intro f
  have h5 : ε >  0 := by norm_num
  have s₁ : 0 ≤ σ₁*f₁ := by
    exact Right.mul_nonneg l₁ f.left
  have s₂ : 0 ≤ σ₂*f₂  := by
    exact Right.mul_nonneg l₂ f.right
  linarith
